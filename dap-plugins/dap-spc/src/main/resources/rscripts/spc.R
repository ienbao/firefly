#intspc
int.A2 <- c(0, 1.880603141, 1.023066041, 0.728508985, 0.576801714, 0.483324732, 0.419339282, 0.372553625, 0.336700337, 0.308214197,
0.285072182, 0.265815041, 0.249415556, 0.235334231, 0.223098119, 0.212344281, 0.202788984, 0.194260105, 0.186567417, 0.179603854,
0.173280485, 0.167478960, 0.162141846, 0.157220138, 0.152632918, 0.148422908, 0.144445902, 0.140786369, 0.137314768, 0.134048595,
0.131003138, 0.128130004, 0.125386067, 0.122820663, 0.120363768, 0.118035883, 0.115801118, 0.113706604, 0.111691342, 0.109750497,
0.107929345, 0.106147684, 0.104474928, 0.102834701, 0.101294133, 0.099780255, 0.098335949, 0.096957614, 0.095620578, 0.094322825,
0.093062478, 0.091858059, 0.090706954, 0.089567418, 0.088477672, 0.087416455, 0.086401328, 0.085393301, 0.084428606, 0.083487462,
0.082586678, 0.081707137, 0.080830726, 0.080008534, 0.079187956, 0.078385581, 0.077617182, 0.076865294, 0.076129334, 0.075408745,
0.074718677, 0.074027092, 0.073364697, 0.072715370, 0.072078685, 0.071454236, 0.070856317, 0.070255038, 0.069679267, 0.069099752,
0.068544794, 0.067999708, 0.067464204, 0.066951695, 0.066434399, 0.065939323, 0.065439219, 0.064960608, 0.064489832, 0.064026679,
0.063570942, 0.063122426, 0.062680941, 0.062246303, 0.061830756, 0.061409189, 0.061006179, 0.060597033, 0.060205939, 0.059820538)


int.A3 <- c(0, 2.658679313, 1.954409883, 1.628102349, 1.42729869, 1.287128109, 1.181915842, 1.099095543, 1.031660633, 0.975350352,
0.927394303, 0.885906021, 0.849545841, 0.817336828, 0.788541232, 0.762595019, 0.739057837, 0.71576218, 0.69786801, 0.679701371,
0.66288471, 0.647259226, 0.63268947, 0.619062646, 0.606281072, 0.594260105, 0.582927133, 0.52219137, 0.56208123, 0.552463802,
0.543323864, 0.534623648, 0.526328329, 0.51840766, 0.510834415, 0.5035835, 0.496633667, 0.489963186, 0.483555132, 0.477391705,
0.471458472, 0.465740823, 0.460226696, 0.454904096, 0.449761494, 0.444790005, 0.439979664, 0.435322086, 0.430809051, 0.426434192,
0.422189484, 0.418069507, 0.41406756, 0.410178591, 0.406397066, 0.40271819, 0.399137465, 0.395650666, 0.392253817, 0.388942785,
0.38571444, 0.382565072, 0.379491547, 0.376490904, 0.373560342, 0.370697581, 0.367899361, 0.365163306, 0.36248789, 0.359870233,
0.357308302, 0.354800514, 0.352344668, 0.349939359, 0.347582557, 0.345272668, 0.343008168, 0.340787603, 0.338609922, 0.336473115,
0.334376588, 0.332318785, 0.330298208, 0.328314076, 0.326365645, 0.324451233, 0.322570182, 0.320721224, 0.318904095, 0.31711728,
0.31536026, 0.313631913, 0.311932092, 0.31025942, 0.308613182, 0.306992995, 0.30539819, 0.303827816, 0.302281558, 0.300758513)

int.A4 <- c(0, 1.88, 1.186756608, 0.796260321, 0.691008453, 0.548090246, 0.509077889, 0.432907313, 0.411784512, 0.361843467, 0.35006864, 0.315788269, 0.30752938, 0.282401077, 0.275972373)

int.B3 <- c(0, 0, 0, 0, 0, 0.030363634, 0.117688814, 0.185085438, 0.23913584, 0.283701688,
0.321280566, 0.353506029, 0.381560864, 0.406239328, 0.428195204, 0.447896458, 0.465668061, 0.481849180, 0.496635619, 0.510225608,
0.522780364, 0.534406023, 0.545238469, 0.555337533, 0.564778101, 0.573652697, 0.582019177, 0.589910435, 0.597352673, 0.604415090,
0.611123492, 0.617485022, 0.623555888, 0.629349068, 0.634880500, 0.640181532, 0.645224957, 0.650100124, 0.654752210, 0.659245922,
0.663553941, 0.667719399, 0.671714957, 0.675562234, 0.679307276, 0.682895240, 0.686378170, 0.689750124, 0.693038643, 0.696179859,
0.699265236, 0.702224880, 0.705122769, 0.707922483, 0.710654513, 0.713312874, 0.715903635, 0.718417796, 0.720858412, 0.723252913,
0.725567911, 0.727833840, 0.730053736, 0.732221598, 0.734337447, 0.736367916, 0.738376803, 0.740370138, 0.742269128, 0.744146578,
0.746002499, 0.747800519, 0.749574024, 0.751286649, 0.752971774, 0.754635427, 0.756268586, 0.757877280, 0.759422151, 0.760975923,
0.762462884, 0.763919400, 0.765387841, 0.766822836, 0.768191064, 0.769565213, 0.770908949, 0.772261619, 0.773538529, 0.774827391,
0.776079845, 0.777338239, 0.778523914, 0.779715536, 0.780913105, 0.782074291, 0.783202109, 0.784335881, 0.785430276, 0.786533638)

int.B4 <- c(0, 3.266529638, 2.568168201, 2.266044949, 2.088993879, 1.969636366, 1.882311186, 1.814914562, 1.76086416, 1.716298312,
1.678719434, 1.646493971, 1.618439136, 1.593760672, 1.571804796, 1.552103542, 1.534331939, 1.518150820, 1.503364381, 1.489774392,
1.477219636, 1.465593977, 1.454761531, 1.444662467, 1.435221899, 1.426347303, 1.417980823, 1.410089565, 1.402647327, 1.395584910,
1.388876508, 1.382514978, 1.376444112, 1.370650932, 1.365119500, 1.359818468, 1.354775043, 1.349899876, 1.345247790, 1.340754078,
1.336446059, 1.332280601, 1.328285043, 1.324437766, 1.320692724, 1.317104760, 1.313621830, 1.310249876, 1.306961357, 1.303820141,
1.300734764, 1.297775120, 1.294877231, 1.292077517, 1.289345487, 1.286687126, 1.284096365, 1.281582204, 1.279141588, 1.276747087,
1.274432089, 1.272166160, 1.269946264, 1.267778402, 1.265662553, 1.263632084, 1.261623197, 1.259629862, 1.257730872, 1.255853422,
1.253997501, 1.252199481, 1.250425976, 1.248713351, 1.247028226, 1.245364573, 1.243731414, 1.242122720, 1.240577849, 1.239024077,
1.237537116, 1.236080600, 1.234612159, 1.233177164, 1.231808936, 1.230434787, 1.229091051, 1.227738381, 1.226461471, 1.225172609,
1.223920155, 1.222661761, 1.221476086, 1.220284464, 1.219086895, 1.217925709, 1.216797891, 1.215664119, 1.214569724, 1.213466362)

int.D3 <- c(0, 0, 0, 0, 0, 0, 0.075591716, 0.136143309, 0.184040404, 0.223099415,
0.255625591, 0.283149171, 0.307194245, 0.328147931, 0.346601382, 0.363052095, 0.377842809, 0.391263736, 0.403496883, 0.414698795,
0.424933827, 0.434485467, 0.443312597, 0.451527599, 0.459374205, 0.467160192, 0.473736803, 0.479766327, 0.485655657, 0.491283407,
0.496539023, 0.501557139, 0.506467227, 0.511037240, 0.515510325, 0.519776912, 0.523955154, 0.527826636, 0.531619856, 0.535337344,
0.538768487, 0.542236872, 0.545430464, 0.548665075, 0.551634881, 0.554648545, 0.557506067, 0.560211151, 0.562866801, 0.565473544,
0.568032565, 0.570450872, 0.572732115, 0.575066257, 0.577266404, 0.579428914, 0.581463144, 0.583553436, 0.585519455, 0.587452468,
0.589265749, 0.591050397, 0.592893713, 0.594535951, 0.596238561, 0.597915941, 0.599484117, 0.601029791, 0.602554384, 0.604058044,
0.605459391, 0.606925251, 0.608290639, 0.609640325, 0.610974407, 0.612294228, 0.613519793, 0.614813030, 0.616015483, 0.617285538,
0.618466996, 0.619639163, 0.620803319, 0.621882184, 0.623032666, 0.624099878, 0.625239268, 0.626298598, 0.627354492, 0.628408180,
0.629460279, 0.630511403, 0.631562160, 0.632613760, 0.633592607, 0.634647413, 0.635631885, 0.636693461, 0.637685903, 0.638683948)

int.D4 <- c(0, 3.267287234, 2.574246899, 2.281301603, 2.114488392, 2.00394633, 1.924408284, 1.863856691, 1.815959596, 1.776900585,
1.744374409, 1.716850829, 1.692805755, 1.671852069, 1.653398618, 1.636947905, 1.622157191, 1.608736264, 1.596503117, 1.585301205,
1.575066173, 1.565514533, 1.556687403, 1.548472401, 1.540625795, 1.532839808, 1.526263197, 1.520233673, 1.514344343, 1.508716593,
1.503460977, 1.498442861, 1.493532773, 1.488962760, 1.484489675, 1.480223088, 1.476044846, 1.472173364, 1.468380144, 1.464662656,
1.461231513, 1.457763128, 1.454569536, 1.451334925, 1.448365119, 1.445351455, 1.442493933, 1.439788849, 1.437133199, 1.434526456,
1.431967435, 1.429549128, 1.427267885, 1.424933743, 1.422733596, 1.420571086, 1.418536856, 1.416446564, 1.414480545, 1.412547532,
1.410734251, 1.408949603, 1.407106287, 1.405464049, 1.403761439, 1.402084059, 1.400515883, 1.398970209, 1.397445616, 1.395941956,
1.394540609, 1.393074749, 1.391709361, 1.390359675, 1.389025593, 1.387705772, 1.386480207, 1.385186970, 1.383984517, 1.382714462,
1.381533004, 1.380360837, 1.379196681, 1.378117816, 1.376967334, 1.375900122, 1.374760732, 1.373701402, 1.372645508, 1.371591820,
1.370539721, 1.369488597, 1.368437840, 1.367386240, 1.366407393, 1.365352587, 1.364368115, 1.363306539, 1.362314097, 1.361316052)

int.d2 <- c(0, 1.128, 1.693, 2.059, 2.326, 2.534, 2.704, 2.847, 2.970, 3.078,
3.173, 3.258, 3.336, 3.407, 3.472, 3.532, 3.588, 3.640, 3.689, 3.735,
3.778, 3.819, 3.858, 3.895, 3.931, 3.964, 3.997, 4.027, 4.057, 4.086,
4.113, 4.139, 4.165, 4.189, 4.213, 4.236, 4.259, 4.280, 4.301, 4.322,
4.341, 4.361, 4.379, 4.398, 4.415, 4.433, 4.450, 4.466, 4.482, 4.498,
4.514, 4.529, 4.543, 4.558, 4.572, 4.586, 4.599, 4.613, 4.626, 4.639,
4.651, 4.663, 4.676, 4.687, 4.699, 4.711, 4.722, 4.733, 4.744, 4.755,
4.765, 4.776, 4.786, 4.796, 4.806, 4.816, 4.825, 4.835, 4.844, 4.854,
4.863, 4.872, 4.881, 4.889, 4.898, 4.906, 4.915, 4.923, 4.931, 4.939,
4.947, 4.955, 4.963, 4.971, 4.978, 4.986, 4.993, 5.001, 5.008, 5.015)

intspc.normal.range.fun <- function(x) {
    if (length(na.exclude(x)) == 0) {
        return(NA)
    }
    return(max(x, na.rm = T) - min(x, na.rm = T))
}

intspc.normal.controlLine.fun <- function(x, avg, constants) {
    slength <- length(na.exclude(x))
    return(avg * constants[slength])
}

intspc.normal.xbarControlLine.fun <- function(x, avg, rcl, scl, i) {
    slength <- length(na.exclude(x))
    return(avg + i * (int.A2[slength] * rcl + int.A3[slength] * scl) / 2)
}

intspc.normal.medianControlLine.fun <- function(x, avg, rcl, i) {
    slength <- length(na.exclude(x))
    return(avg + i * int.A4[slength] * rcl)
}

intspc.normal.getDSResult <- function(x) {
    Samples <- length(x)
    Mean <- mean(x)
    Max <- max(x)
    Min <- min(x)
    if (length(x) == 0) {
        Max <- NaN
        Min <- NaN
    }
    Range <- Max - Min
    SD <- NaN
    Plus3SD <- NaN
    Minus3SD <- NaN
    Kurtosis <- NaN
    Skewness <- NaN
    SD <- sd(x)
    Plus3SD <- Mean + 3 * SD
    Minus3SD <- Mean - 3 * SD
    Kurtosis <- ((Samples * (Samples + 1)) / ((Samples - 1) * (Samples - 2) * (Samples - 3)) * sum((x - Mean) ^ 4) / SD ^ 4 - (3 * (Samples - 1) ^ 2) / ((Samples - 2) * (Samples - 3))) + 3
    Skewness <- Samples / ((Samples - 1) * (Samples - 2) * SD ^ 3) * sum((x - Mean) ^ 3)
    Result <- data.frame(Samples, Mean, SD, Max, Min, Range, Plus3SD, Minus3SD, Kurtosis, Skewness)
    return(Result)
}

intspc.normal.getPPResult <- function(x, usl = NaN, lsl = NaN, SD = NaN, Mean = NaN) {
    Pp <- NaN
    Ppl <- NaN
    Ppu <- NaN
    Ppk <- NaN
    OverallPPM <- NaN
    if (length(x) > 1) {
        if (is.na(SD)) {
            SD <- sd(x)
        }
        if (is.na(Mean)) {
            Mean <- mean(x)
        }
        if (! is.na(lsl)) {
            Ppl = (Mean - lsl) / (3 * SD)
        }
        if (! is.na(usl)) {
            Ppu = (usl - Mean) / (3 * SD)
        }
        if (! is.na(lsl) && ! is.na(usl)) {
            Pp = (usl - lsl) / (6 * SD)
        }
        if (! is.na(Ppl) && (! is.na(Ppu))) {
            Ppk = min(c(Ppl, Ppu))
        } else {
            if (! is.na(Ppl)) {
                Ppk = Ppl
            }
            if (! is.na(Ppu)) {
                Ppk = Ppu
            }
        }
    }
    if (! is.na(Pp) && ! is.na(Ppk)) {
        OverallPPM <- (pnorm(3 * Ppk - 6 * Pp) + pnorm(- 3 * Ppk)) * 1000000
    }
    Result <- data.frame(Pp, Ppl, Ppu, Ppk, OverallPPM)
    return(Result)
}

intspc.normal.getPCResult <- function(x, SubGroupSize, usl = NaN, lsl = NaN, RCenterLine = NaN, XBCenterLine = NaN, Mean = NaN) {
    Ca <- NaN
    Cp <- NaN
    Cpl <- NaN
    Cpu <- NaN
    Cpk <- NaN
    RSD <- NaN
    WithinPPM <- NaN
    if (length(x) > 1 && ! is.nan(SubGroupSize)) {
        if (is.na(RCenterLine) || is.na(XBCenterLine)) {
            l <- length(x)
            SubGroups <- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
            claData <- apply(SubGroups, 2, intspc.normal.range.fun)
            RCenterLine <- mean(claData, na.rm = T)
            claData <- apply(SubGroups, 2, mean, na.rm = T)
            XBCenterLine = mean(claData, na.rm = T)
        }
        RSD <- RCenterLine / int.d2[SubGroupSize]
        if (! is.na(lsl)) {
            Cpl = (XBCenterLine - lsl) / (3 * RSD)
        }
        if (! is.na(usl)) {
            Cpu = (usl - XBCenterLine) / (3 * RSD)
        }
        if (! is.na(lsl) && ! is.na(usl)) {
            Cp = (usl - lsl) / (6 * RSD)
        }
        if (! is.na(Cpl) && (! is.na(Cpu))) {
            Cpk = min(c(Cpl, Cpu))
        } else {
            if (! is.na(Cpl)) {
                Cpk = Cpl
            }
            if (! is.na(Cpu)) {
                Cpk = Cpu
            }
        }
    }
    if (is.na(Mean)) {
        Mean <- mean(x)
        if (! is.na(usl) && (! is.na(lsl))) {
            Ca <- (Mean - (usl + lsl) / 2) / ((usl - lsl) / 2) * 100
        }
    }
    if (! is.na(Cp) && ! is.na(Cpk)) {
        WithinPPM <- (pnorm(3 * Cpk - 6 * Cp) + pnorm(- 3 * Cpk)) * 1000000
    }
    Result <- data.frame(Ca, Cp, Cpl, Cpu, Cpk, WithinPPM, RSD)
    return(Result)
}

intspc.normal.getNDCResult <- function(x, Intervals, Max = NaN, Min = NaN, SD = NaN, Mean = NaN) {
    Breaks <- NaN
    CLs <- NaN
    Counts <- NaN
    Normal.X <- NaN
    Normal.Y <- NaN
    if (is.na(Max) || is.na(Min)) {
        r <- range(x)
        Max <- r[2]
        Min <- r[1]
    }
    Breaks <- seq(Min, Max, length = Intervals + 1)
    h <- hist(x, breaks = Breaks, plot = F)
    Counts <- h$counts
    if (length(x) > 1 && (is.na(SD) || is.na(Mean))) {
        Mean <- mean(x)
        SD <- sd(x)
    }
    if (! is.na(SD) && ! is.na(Mean)) {
        cl <- c(- 3, - 2, - 1, 0, 1, 2, 3)
        CLs <- Mean + SD * cl
        Normal.X <- seq(Mean - 4 * SD, Mean + 4 * SD, length = 100)
        Normal.Y <- dnorm(Normal.X, mean = Mean, sd = SD)
    }
    Result <- list(Breaks = Breaks, Counts = Counts, CLs = CLs, Normal.X = Normal.X, Normal.Y = Normal.Y)
    return(Result)
}

intspc.normal.getRunCResult <- function(x, SD = NaN, Mean = NaN) {
    CLs <- NaN
    if (length(x) > 1 && (is.na(SD) || is.na(Mean))) {
        Mean <- mean(x)
        SD <- sd(x)
    } else {
        if (length(x) == 1) {
            Mean <- x
            SD <- NaN
            cl <- c(NaN, NaN, NaN, Mean, NaN, NaN, NaN)
        }
    }
    if (! is.na(SD) && ! is.na(Mean)) {
        cl <- c(- 3, - 2, - 1, 0, 1, 2, 3)
        CLs <- Mean + SD * cl
    }
    Result <- list(CLs = CLs, Values = x)
    return(Result)
}

intspc.normal.getRangeCResult <- function(x, SubGroupSize, RCenterLine = NaN) {
    UCL <- NaN
    LCL <- NaN
    Values <- NaN
    CenterLine <- NaN
    if (length(x) > 1) {
        if (! exists('SubGroups')) {
            l <- length(x)
            SubGroups <<- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
        }
        Values <- apply(SubGroups, 2, intspc.normal.range.fun)
    } else {
        if (length(x) == 1) {
            Values <- 0
        }
    }
    if (is.na(RCenterLine)) {
        if (length(na.exclude(Values)) > 0) {
            CenterLine <- mean(Values, na.rm = T)
        }
    } else {
        CenterLine <- RCenterLine
    }
    if (exists('SubGroups') && ! is.nan(CenterLine)) {
        UCL <- apply(SubGroups, 2, intspc.normal.controlLine.fun, avg = CenterLine, constants = int.D4)
        LCL <- apply(SubGroups, 2, intspc.normal.controlLine.fun, avg = CenterLine, constants = int.D3)
    }
    Result <- list(Values = Values, CenterLine = CenterLine, UCL = UCL, LCL = LCL)
    return(Result)
}

intspc.normal.getSDCResult <- function(x, SubGroupSize, SDCenterLine = NaN) {
    UCL <- NaN
    LCL <- NaN
    Values <- NaN
    CenterLine <- NaN
    if (length(x) > 1) {
        if (! exists('SubGroups')) {
            l <- length(x)
            SubGroups <<- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
        }
        Values <- apply(SubGroups, 2, sd, na.rm = T)
    }
    if (is.na(SDCenterLine)) {
        if (length(na.exclude(Values)) > 0) {
            CenterLine <- mean(Values, na.rm = T)
        }
    } else {
        CenterLine <- SDCenterLine
    }
    if (exists('SubGroups') && ! is.nan(CenterLine)) {
        UCL <- apply(SubGroups, 2, intspc.normal.controlLine.fun, avg = CenterLine, constants = int.B4)
        LCL <- apply(SubGroups, 2, intspc.normal.controlLine.fun, avg = CenterLine, constants = int.B3)
    }
    Result <- list(Values = Values, CenterLine = CenterLine, UCL = UCL, LCL = LCL)
    return(Result)
}

intspc.normal.getXBCResult <- function(x, SubGroupSize, XBCenterLine = NaN, RCenterLine = NaN, SDCenterLine = NaN) {
    UCL <- NaN
    LCL <- NaN
    Values <- NaN
    CenterLine <- NaN
    if (length(x) > 1) {
        if (! exists('SubGroups')) {
            l <- length(x)
            SubGroups <<- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
        }
        Values <- apply(SubGroups, 2, mean, na.rm = T)
        if (is.na(SDCenterLine)) {
            SDCenterLine <- mean(apply(SubGroups, 2, sd, na.rm = T), na.rm = T)
        }
        if (is.na(RCenterLine)) {
            RCenterLine <- mean(apply(SubGroups, 2, intspc.normal.range.fun), na.rm = T)
        }
    }else {
        if (length(x) == 1) {
            Values <- x
        }
    }
    if (is.na(XBCenterLine)) {
        if (length(na.exclude(Values)) > 0) {
            CenterLine <- mean(Values, na.rm = T)
        }
    }else {
        CenterLine <- XBCenterLine
    }
    if (exists('SubGroups') &&
        ! is.nan(CenterLine) &&
        ! is.na(RCenterLine) &&
        ! is.na(SDCenterLine)) {
        UCL <- apply(SubGroups, 2, intspc.normal.xbarControlLine.fun, avg = CenterLine, rcl = RCenterLine, scl = SDCenterLine, i = 1)
        LCL <- apply(SubGroups, 2, intspc.normal.xbarControlLine.fun, avg = CenterLine, rcl = RCenterLine, scl = SDCenterLine, i = - 1)
    }
    Result <- list(Values = Values, CenterLine = CenterLine, UCL = UCL, LCL = LCL)
    return(Result)
}

intspc.normal.getMECResult <- function(x, SubGroupSize, MECenterLine = NaN, RCenterLine = NaN) {
    UCL <- NaN
    LCL <- NaN
    Values <- NaN
    CenterLine <- NaN
    if (length(x) > 1 && SubGroupSize < 16) {
        if (! exists('SubGroups')) {
            l <- length(x)
            SubGroups <<- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
        }
        Values <- apply(SubGroups, 2, median, na.rm = T)
        if (is.na(RCenterLine)) {
            RCenterLine <- mean(apply(SubGroups, 2, intspc.normal.range.fun), na.rm = T)
        }
    }else {
        if (length(x) == 1) {
            Values <- x
        }
    }
    if (is.na(MECenterLine)) {
        if (length(na.exclude(Values)) > 0) {
            CenterLine <- mean(Values, na.rm = T)
        }
    }else {
        CenterLine <- MECenterLine
    }
    if (exists('SubGroups') &&
        ! is.nan(CenterLine) &&
        ! is.na(RCenterLine)) {
        UCL <- apply(SubGroups, 2, intspc.normal.medianControlLine.fun, avg = CenterLine, rcl = RCenterLine, i = 1)
        LCL <- apply(SubGroups, 2, intspc.normal.medianControlLine.fun, avg = CenterLine, rcl = RCenterLine, i = - 1)
    }
    Result <- list(Values = Values, CenterLine = CenterLine, UCL = UCL, LCL = LCL)
    return(Result)
}

intspc.normal.getMRCResult <- function(x, MRCenterLine = NaN) {
    UCL <- NaN
    LCL <- NaN
    Values <- NaN
    CenterLine <- NaN
    if (length(x) > 1) {
        l <- length(x)
        Values <- abs(x[2 : l] - x[1 : l - 1])
        CenterLine <- mean(Values)
        LCL <- rep(0, l - 1)
        UCL <- rep(CenterLine * 3.266529638, l - 1)
    }
    Result <- list(Values = Values, CenterLine = CenterLine, UCL = UCL, LCL = LCL)
    return(Result)
}

intspc.normal.getBoxCResult <- function(x, SubGroupSize) {
    Values <- NaN
    Outs <- NaN
    CenterLine <- NaN
    MEs <- NaN
    if (length(x) > 1) {
        if (! exists('SubGroups')) {
            l <- length(x)
            SubGroups <<- matrix(c(x, rep(NA, ceiling(l / SubGroupSize) * SubGroupSize - l)), nrow = SubGroupSize)
        }
        for (i in c(1 : ncol(SubGroups))) {
            b <- boxplot(SubGroups[, i], plot = F)
            if (i == 1) {
                MEs <- b$stats[, 1][3]
                Values <- b$stats[, 1]
            }else {
                Values <- c(Values, b$stats[, 1])
                MEs <- c(MEs, b$stats[, 1][3])
            }
            if (length(b$out) > 0) {
                if (length(na.exclude(Outs)) == 0) {
                    Outs <- c(i, b$out[1])
                    if (length(b$out) > 1) {
                        for (j in c(1 : length(b$out))) {
                            Outs <- c(Outs, i, b$out[j])
                        }
                    }
                }else {
                    for (j in c(1 : length(b$out))) {
                        Outs <- c(Outs, i, b$out[j])
                    }
                }
            }
        }
    }
    Result <- list(Values = Values, Outs = Outs, CenterLine = MEs)
    return(Result)
}

